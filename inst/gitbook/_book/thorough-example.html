<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Thorough example | dads manual</title>
  <meta name="description" content="dads R package vignette" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Thorough example | dads manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="dads R package vignette" />
  <meta name="github-repo" content="TGuillerme/dads" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Thorough example | dads manual" />
  
  <meta name="twitter:description" content="dads R package vignette" />
  

<meta name="author" content="Thomas Guillerme (guillert@tcd.ie), Alex Slavenko (email) and others" />


<meta name="date" content="2021-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="makeevents.html"/>
<link rel="next" href="bugged-from-here.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">dads manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <code>dads</code>: disparity and diversity simulations.</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-dads"><i class="fa fa-check"></i><b>1.1</b> What is <code>dads</code>?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#modular"><i class="fa fa-check"></i><b>1.1.1</b> Modular?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-and-running-the-package"><i class="fa fa-check"></i><b>1.2</b> Installing and running the package</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.3</b> Help</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-does-dads-work"><i class="fa fa-check"></i><b>1.4</b> How does <code>dads</code> work?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>2</b> Getting started</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-started.html"><a href="getting-started.html#the-simplest-of-all-analysis-simulating-diversity-only"><i class="fa fa-check"></i><b>2.1</b> The simplest of all analysis: simulating diversity only</a><ul>
<li class="chapter" data-level="2.1.1" data-path="getting-started.html"><a href="getting-started.html#changing-the-birth-death-parameters"><i class="fa fa-check"></i><b>2.1.1</b> Changing the birth-death parameters</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="getting-started.html"><a href="getting-started.html#slightly-more-complex-simulating-disparity-and-diversity"><i class="fa fa-check"></i><b>2.2</b> Slightly more complex: simulating disparity and diversity</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started.html"><a href="getting-started.html#slightly-more-more-complex-simulating-linked-disparity-and-diversity"><i class="fa fa-check"></i><b>2.3</b> Slightly more more complex: simulating linked disparity and diversity</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="maketraits.html"><a href="maketraits.html"><i class="fa fa-check"></i><b>3</b> Making trait processes with <code>make.traits()</code></a><ul>
<li class="chapter" data-level="3.1" data-path="maketraits.html"><a href="maketraits.html#the-process-process"><i class="fa fa-check"></i><b>3.1</b> The process (<code>process</code>)</a></li>
<li class="chapter" data-level="3.2" data-path="maketraits.html"><a href="maketraits.html#the-number-of-traits-n-and-the-starting-values-start"><i class="fa fa-check"></i><b>3.2</b> The number of traits <code>n</code> and the starting values <code>start</code></a></li>
<li class="chapter" data-level="3.3" data-path="maketraits.html"><a href="maketraits.html#extra-argument-for-the-processes-with-process.args"><i class="fa fa-check"></i><b>3.3</b> Extra argument for the processes with <code>process.args</code></a></li>
<li class="chapter" data-level="3.4" data-path="maketraits.html"><a href="maketraits.html#naming-the-traits-with-trait.names"><i class="fa fa-check"></i><b>3.4</b> Naming the traits with <code>trait.names</code></a></li>
<li class="chapter" data-level="3.5" data-path="maketraits.html"><a href="maketraits.html#combining-multiple-traits-with-add"><i class="fa fa-check"></i><b>3.5</b> Combining multiple traits with <code>add</code></a></li>
<li class="chapter" data-level="3.6" data-path="maketraits.html"><a href="maketraits.html#testing-the-traits-with-test"><i class="fa fa-check"></i><b>3.6</b> Testing the traits with <code>test</code></a></li>
<li class="chapter" data-level="3.7" data-path="maketraits.html"><a href="maketraits.html#templates-for-making-your-very-own-process"><i class="fa fa-check"></i><b>3.7</b> Templates for making your very own process</a><ul>
<li class="chapter" data-level="3.7.1" data-path="maketraits.html"><a href="maketraits.html#a-simple-brownian-motion-process-template"><i class="fa fa-check"></i><b>3.7.1</b> A simple Brownian Motion process template</a></li>
<li class="chapter" data-level="3.7.2" data-path="maketraits.html"><a href="maketraits.html#a-simple-ornstein-uhlenbeck-process-template"><i class="fa fa-check"></i><b>3.7.2</b> A simple Ornstein-Uhlenbeck process template</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="makemodifiers.html"><a href="makemodifiers.html"><i class="fa fa-check"></i><b>4</b> Making modifiers with <code>make.modifiers()</code></a><ul>
<li class="chapter" data-level="4.1" data-path="makemodifiers.html"><a href="makemodifiers.html#the-branch-length-function-branch.length"><i class="fa fa-check"></i><b>4.1</b> The branch length function (<code>branch.length</code>)</a><ul>
<li class="chapter" data-level="4.1.1" data-path="makemodifiers.html"><a href="makemodifiers.html#allowarguments"><i class="fa fa-check"></i><b>4.1.1</b> The allowed arguments</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="makemodifiers.html"><a href="makemodifiers.html#the-selection-function-selection"><i class="fa fa-check"></i><b>4.2</b> The selection function (<code>selection</code>)</a></li>
<li class="chapter" data-level="4.3" data-path="makemodifiers.html"><a href="makemodifiers.html#the-speciation-function-speciation"><i class="fa fa-check"></i><b>4.3</b> The speciation function (<code>speciation</code>)</a></li>
<li class="chapter" data-level="4.4" data-path="makemodifiers.html"><a href="makemodifiers.html#summarymodifiers"><i class="fa fa-check"></i><b>4.4</b> Summary of the inputs and outputs for the <code>branch.length</code>, <code>selection</code> and <code>speciation</code> modifiers</a></li>
<li class="chapter" data-level="4.5" data-path="makemodifiers.html"><a href="makemodifiers.html#the-condition-and-modify-functions-condition-and-modify"><i class="fa fa-check"></i><b>4.5</b> The condition and modify functions (<code>condition</code> and <code>modify</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="makemodifiers.html"><a href="makemodifiers.html#combining-and-editing-modifiers-add"><i class="fa fa-check"></i><b>4.6</b> Combining and editing modifiers (<code>add</code>)</a></li>
<li class="chapter" data-level="4.7" data-path="makemodifiers.html"><a href="makemodifiers.html#testing-modifiers-test"><i class="fa fa-check"></i><b>4.7</b> Testing modifiers (<code>test</code>)</a></li>
<li class="chapter" data-level="4.8" data-path="makemodifiers.html"><a href="makemodifiers.html#demo-runnable"><i class="fa fa-check"></i><b>4.8</b> Demo runnable</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="makeevents.html"><a href="makeevents.html"><i class="fa fa-check"></i><b>5</b> Making events with <code>make.events()</code></a><ul>
<li class="chapter" data-level="5.1" data-path="makeevents.html"><a href="makeevents.html#conditions"><i class="fa fa-check"></i><b>5.1</b> Conditions</a></li>
<li class="chapter" data-level="5.2" data-path="makeevents.html"><a href="makeevents.html#modifications"><i class="fa fa-check"></i><b>5.2</b> Modifications</a></li>
<li class="chapter" data-level="5.3" data-path="makeevents.html"><a href="makeevents.html#some-events-examples"><i class="fa fa-check"></i><b>5.3</b> Some events examples</a><ul>
<li class="chapter" data-level="5.3.1" data-path="makeevents.html"><a href="makeevents.html#random-mass-extinction-after-some-time"><i class="fa fa-check"></i><b>5.3.1</b> Random mass extinction after some time</a></li>
<li class="chapter" data-level="5.3.2" data-path="makeevents.html"><a href="makeevents.html#extinction-based-on-a-trait-value-after-some-time"><i class="fa fa-check"></i><b>5.3.2</b> Extinction based on a trait value after some time</a></li>
<li class="chapter" data-level="5.3.3" data-path="makeevents.html"><a href="makeevents.html#adding-a-background-extinction-after-reaching-a-number-of-living-taxa"><i class="fa fa-check"></i><b>5.3.3</b> Adding a background extinction after reaching a number of living taxa</a></li>
<li class="chapter" data-level="5.3.4" data-path="makeevents.html"><a href="makeevents.html#reducing-speciation-after-some-time"><i class="fa fa-check"></i><b>5.3.4</b> Reducing speciation after some time</a></li>
<li class="chapter" data-level="5.3.5" data-path="makeevents.html"><a href="makeevents.html#changing-trait-process-after-some-time"><i class="fa fa-check"></i><b>5.3.5</b> Changing trait process after some time</a></li>
<li class="chapter" data-level="5.3.6" data-path="makeevents.html"><a href="makeevents.html#changing-trait-correlation-after-reaching-a-trait-value"><i class="fa fa-check"></i><b>5.3.6</b> Changing trait correlation after reaching a trait value</a></li>
<li class="chapter" data-level="5.3.7" data-path="makeevents.html"><a href="makeevents.html#event-for-changing-a-modifier"><i class="fa fa-check"></i><b>5.3.7</b> Event for changing a modifier</a></li>
<li class="chapter" data-level="5.3.8" data-path="makeevents.html"><a href="makeevents.html#changing-branch-length-when-reaching-n-taxa"><i class="fa fa-check"></i><b>5.3.8</b> Changing branch length when reaching n taxa</a></li>
<li class="chapter" data-level="5.3.9" data-path="makeevents.html"><a href="makeevents.html#founding-event-a-subtree-with-no-fossils"><i class="fa fa-check"></i><b>5.3.9</b> Founding event: a subtree with no fossils</a></li>
<li class="chapter" data-level="5.3.10" data-path="makeevents.html"><a href="makeevents.html#founding-event-with-traits"><i class="fa fa-check"></i><b>5.3.10</b> Founding event with traits</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="thorough-example.html"><a href="thorough-example.html"><i class="fa fa-check"></i><b>6</b> Thorough example</a><ul>
<li class="chapter" data-level="6.1" data-path="thorough-example.html"><a href="thorough-example.html#step-1"><i class="fa fa-check"></i><b>6.1</b> Step 1:</a><ul>
<li class="chapter" data-level="6.1.1" data-path="thorough-example.html"><a href="thorough-example.html#the-birth-death-parameters"><i class="fa fa-check"></i><b>6.1.1</b> The birth death parameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="thorough-example.html"><a href="thorough-example.html#the-traits"><i class="fa fa-check"></i><b>6.1.2</b> The traits</a></li>
<li class="chapter" data-level="6.1.3" data-path="thorough-example.html"><a href="thorough-example.html#the-modifiers"><i class="fa fa-check"></i><b>6.1.3</b> The modifiers</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="thorough-example.html"><a href="thorough-example.html#step-2"><i class="fa fa-check"></i><b>6.2</b> Step 2:</a></li>
<li class="chapter" data-level="6.3" data-path="thorough-example.html"><a href="thorough-example.html#step-3"><i class="fa fa-check"></i><b>6.3</b> Step 3:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bugged-from-here.html"><a href="bugged-from-here.html"><i class="fa fa-check"></i><b>7</b> BUGGED FROM HERE</a><ul>
<li class="chapter" data-level="7.1" data-path="bugged-from-here.html"><a href="bugged-from-here.html#step-4-and-5"><i class="fa fa-check"></i><b>7.1</b> Step 4 and 5:</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/TGuillerme/dads/" target="blank">Project GitHub page</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">dads manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="thorough-example" class="section level1">
<h1><span class="header-section-number">6</span> Thorough example</h1>
<p>Here we are going to look at an example on how to simulate complex evolutionary histories with <code>dads</code>.</p>
<p>Let say we want to simulate the following story:</p>
<ol style="list-style-type: decimal">
<li>A lineage evolves in a normal birth-death fashion (with extinction) from a single origin and with two traits called:
<ul>
<li>“Distance”: the physical distance between species in an arbitrary 1D space (evolving in a Brownian motion).</li>
<li>“Variable”: a 2D uncorrelated Ornstein-Uhlenbeck trait that corresponds to some traits the lineages have.
During the whole process, lineages that are more further away from the other species in terms of distance have a higher change of speciating (proportional to that distance).</li>
</ul></li>
</ol>
<p>Three events then happen during the evolutionary history of this lineage:</p>
<ol start="2" style="list-style-type: decimal">
<li>“Correlation event”: after reaching a certain number of taxa an event happens making the “Variables” trait dimensions become correlated.</li>
<li>“Selective extinction event”: after reaching a certain point in time, lineages with their “Variables” values that are negative go extinct</li>
<li>“Founding event”: after reaching a value for the “Distance” trait, a founding event happens with a new birth-death process with no extinction and where the “Variable” is now a 2D correlated Brownian Motion.</li>
<li>“Mass extinction event”: after reaching a certain number of taxa in the “Founding event”, 80% of taxa go extinct randomly.</li>
</ol>
<p>We are going to run each step one by one in a cumulative manner to see how they pile up:</p>
<div id="step-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Step 1:</h2>
<div id="the-birth-death-parameters" class="section level3">
<h3><span class="header-section-number">6.1.1</span> The birth death parameters</h3>
<p>First let’s set the overall birth death parameters (a speciation of 1.2 and an extinction of 0.3):</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="co">## The birth death parameters</span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2">bd_params &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">speciation =</span> <span class="fl">1.2</span>, <span class="dt">extinction =</span> <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="co">## The stopping rule</span></a>
<a class="sourceLine" id="cb104-4" data-line-number="4">stop_rule &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">max.time =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>And let’s quickly test if the simulation works by running a birth death tree without traits and anything:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">0</span>) <span class="co"># 123 also works</span></a>
<a class="sourceLine" id="cb105-2" data-line-number="2"><span class="co">## Running a birth death tree </span></a>
<a class="sourceLine" id="cb105-3" data-line-number="3">results &lt;-<span class="st"> </span><span class="kw">dads</span>(<span class="dt">bd.params =</span> bd_params,</a>
<a class="sourceLine" id="cb105-4" data-line-number="4">                <span class="dt">stop.rule =</span> stop_rule)</a>
<a class="sourceLine" id="cb105-5" data-line-number="5"></a>
<a class="sourceLine" id="cb105-6" data-line-number="6"><span class="co">## And displaying the results</span></a>
<a class="sourceLine" id="cb105-7" data-line-number="7"><span class="kw">plot</span>(results)</a>
<a class="sourceLine" id="cb105-8" data-line-number="8"><span class="kw">axisPhylo</span>()</a></code></pre></div>
<p><img src="dads_manual_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
<div id="the-traits" class="section level3">
<h3><span class="header-section-number">6.1.2</span> The traits</h3>
<p>Then let’s create the traits:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="co">## The trait object</span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2">two_traits &lt;-<span class="st"> </span><span class="kw">make.traits</span>(<span class="dt">process =</span> <span class="kw">c</span>(BM.process, OU.process), <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb106-3" data-line-number="3">                          <span class="dt">trait.names =</span> <span class="kw">c</span>(<span class="st">&quot;Distance&quot;</span>, <span class="st">&quot;Variables&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" data-line-number="1"><span class="co">## Visualise the 1D trait (BM.process)</span></a>
<a class="sourceLine" id="cb107-2" data-line-number="2"><span class="kw">plot</span>(two_traits, <span class="dt">trait =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="dads_manual_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="co">## Visualise the 2D trait (uncorrelated OU.process)</span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="kw">plot</span>(two_traits, <span class="dt">trait =</span> <span class="dv">2</span>, <span class="dt">use.3D =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Note that specifying the correlation matrix is not necessary here <em>per se</em> (since no correlation is the default) but we will modify it through an event later on so it’s good practice to have it properly stated before hand (to avoid any confusion).</p>
<p>We can then run the tree with the traits:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb109-2" data-line-number="2"><span class="co">## Running a birth death tree </span></a>
<a class="sourceLine" id="cb109-3" data-line-number="3">results &lt;-<span class="st"> </span><span class="kw">dads</span>(<span class="dt">bd.params  =</span> bd_params,</a>
<a class="sourceLine" id="cb109-4" data-line-number="4">                <span class="dt">stop.rule  =</span> stop_rule,</a>
<a class="sourceLine" id="cb109-5" data-line-number="5">                <span class="dt">traits     =</span> two_traits)</a>
<a class="sourceLine" id="cb109-6" data-line-number="6"></a>
<a class="sourceLine" id="cb109-7" data-line-number="7"><span class="co">## And displaying the results</span></a>
<a class="sourceLine" id="cb109-8" data-line-number="8"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb109-9" data-line-number="9"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Trait 1: Distance&quot;</span>)</a>
<a class="sourceLine" id="cb109-10" data-line-number="10"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">main =</span> <span class="st">&quot;Variables correlation&quot;</span>)</a></code></pre></div>
<p><img src="dads_manual_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="co">## Visualising the tree in 3D</span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">use.3D =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="the-modifiers" class="section level3">
<h3><span class="header-section-number">6.1.3</span> The modifiers</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" data-line-number="1"><span class="co">## Speciation event is more likely if lineage&#39;s ancestor is further away from the mean trait value</span></a>
<a class="sourceLine" id="cb111-2" data-line-number="2">distance.modify &lt;-<span class="st"> </span><span class="cf">function</span>(x, trait.values, lineage) <span class="kw">return</span>(x <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(<span class="kw">parent.traits</span>(trait.values, lineage)[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(trait.values[,<span class="dv">1</span>])))</a>
<a class="sourceLine" id="cb111-3" data-line-number="3"></a>
<a class="sourceLine" id="cb111-4" data-line-number="4"><span class="co">## Make a distance modifier</span></a>
<a class="sourceLine" id="cb111-5" data-line-number="5">distance.speciation &lt;-<span class="st"> </span><span class="kw">make.modifiers</span>(<span class="dt">speciation =</span> speciation,</a>
<a class="sourceLine" id="cb111-6" data-line-number="6">                                      <span class="dt">modify =</span> distance.modify)</a></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a>
<a class="sourceLine" id="cb112-2" data-line-number="2"><span class="co">## Running a birth death tree </span></a>
<a class="sourceLine" id="cb112-3" data-line-number="3">results &lt;-<span class="st"> </span><span class="kw">dads</span>(<span class="dt">bd.params  =</span> bd_params,</a>
<a class="sourceLine" id="cb112-4" data-line-number="4">                <span class="dt">stop.rule  =</span> stop_rule,</a>
<a class="sourceLine" id="cb112-5" data-line-number="5">                <span class="dt">traits     =</span> two_traits,</a>
<a class="sourceLine" id="cb112-6" data-line-number="6">                <span class="dt">modifiers  =</span> distance.speciation)</a>
<a class="sourceLine" id="cb112-7" data-line-number="7"></a>
<a class="sourceLine" id="cb112-8" data-line-number="8"><span class="co">## And displaying the results</span></a>
<a class="sourceLine" id="cb112-9" data-line-number="9"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb112-10" data-line-number="10"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Trait 1: Distance&quot;</span>)</a>
<a class="sourceLine" id="cb112-11" data-line-number="11"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">main =</span> <span class="st">&quot;Variables correlation&quot;</span>)</a></code></pre></div>
<p><img src="dads_manual_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
</div>
<div id="step-2" class="section level2">
<h2><span class="header-section-number">6.2</span> Step 2:</h2>
<ol start="2" style="list-style-type: decimal">
<li>“Correlation event”: after reaching a certain number of taxa an event happens making the “Variable” trait dimensions become correlated.</li>
</ol>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="co">## The correlation change event</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2">events_list &lt;-<span class="st"> </span><span class="kw">make.events</span>(<span class="dt">event.name   =</span> <span class="st">&quot;Correlation&quot;</span>,</a>
<a class="sourceLine" id="cb113-3" data-line-number="3">                           <span class="dt">target       =</span> <span class="st">&quot;traits&quot;</span>,</a>
<a class="sourceLine" id="cb113-4" data-line-number="4">                           <span class="dt">condition    =</span> <span class="kw">taxa.condition</span>(<span class="dv">30</span>),</a>
<a class="sourceLine" id="cb113-5" data-line-number="5">                           <span class="dt">modification =</span> <span class="kw">update.traits</span>(</a>
<a class="sourceLine" id="cb113-6" data-line-number="6">                    <span class="dt">process.args =</span> <span class="kw">list</span>(<span class="dt">Sigma =</span> <span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.7</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.7</span>), <span class="dv">2</span>, <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb113-7" data-line-number="7">                    <span class="dt">trait.names  =</span> <span class="st">&quot;Variables&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="co">## Running a birth death tree </span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3">results &lt;-<span class="st"> </span><span class="kw">dads</span>(<span class="dt">bd.params  =</span> bd_params,</a>
<a class="sourceLine" id="cb114-4" data-line-number="4">                <span class="dt">stop.rule  =</span> stop_rule,</a>
<a class="sourceLine" id="cb114-5" data-line-number="5">                <span class="dt">traits     =</span> two_traits,</a>
<a class="sourceLine" id="cb114-6" data-line-number="6">                <span class="dt">modifiers  =</span> distance.speciation,</a>
<a class="sourceLine" id="cb114-7" data-line-number="7">                <span class="dt">events     =</span> events_list)</a>
<a class="sourceLine" id="cb114-8" data-line-number="8"></a>
<a class="sourceLine" id="cb114-9" data-line-number="9"><span class="co">## And displaying the results</span></a>
<a class="sourceLine" id="cb114-10" data-line-number="10"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb114-11" data-line-number="11"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Trait 1: Distance&quot;</span>)</a>
<a class="sourceLine" id="cb114-12" data-line-number="12"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">main =</span> <span class="st">&quot;Variables correlation&quot;</span>)</a></code></pre></div>
<p><img src="dads_manual_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="co">## Visualising the tree in 3D</span></a>
<a class="sourceLine" id="cb115-2" data-line-number="2"><span class="kw">plot</span>(results, <span class="dt">trait =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">use.3D =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="step-3" class="section level2">
<h2><span class="header-section-number">6.3</span> Step 3:</h2>
<ol start="3" style="list-style-type: decimal">
<li>“Selective extinction event”: after reaching a certain point in time, lineages with their “Variables” values that are negative go extinct</li>
</ol>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="makeevents.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bugged-from-here.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/TGuillerme/dads/inst/gitbook/edit/master/05_thorough_example.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
